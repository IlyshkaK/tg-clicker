# TG Clicker+ (Telegram WebApp) — кликер с прогрессом + лидербордом

## Фичи
- Кликер + апгрейды (сила клика / авто-майнер / множитель)
- Оффлайн доход
- Ежедневные награды со стриком
- Престиж (постоянный бонус +5% за уровень)
- Лидерборд
- Автосохранение:
  - localStorage (всегда)
  - `/api/progress` (server sync)
- Анти-накрутка (опционально): проверка Telegram WebApp `initData` на сервере

## Деплой на Vercel
Важно: `index.html` и `assets/` должны быть В КОРНЕ репозитория.

Проверка:
- `https://xxx.vercel.app/`
- `https://xxx.vercel.app/assets/coin.png`
- `https://xxx.vercel.app/api/health`
- `https://xxx.vercel.app/api/leaderboard?limit=10`

### Включить Supabase (рекомендуется)
Иначе serverless память может сбрасываться.
Создай таблицы:

```sql
create table if not exists public.progress (
  user_id text primary key,
  state jsonb not null,
  updated_at timestamptz not null default now()
);

create table if not exists public.leaderboard (
  id bigint generated by default as identity primary key,
  user_id text not null,
  name text not null,
  score bigint not null,
  created_at timestamptz not null default now()
);

create index if not exists leaderboard_score_idx on public.leaderboard(score desc);
```

В Vercel → Settings → Environment Variables:
- `SUPABASE_URL`
- `SUPABASE_SERVICE_ROLE_KEY` (service_role)

## Анти-накрутка (initData verify)
В Vercel добавь env:
- `TELEGRAM_BOT_TOKEN` = токен твоего бота (из BotFather)

После этого `/api/progress` и `/api/leaderboard` будут принимать POST **только** с валидным `initData`.
(Без этого env — работает в dev-режиме и не проверяет.)

## Бот
В `bot/`:
1) `.env.example` → `.env`
2) Заполни `BOT_TOKEN` и `WEBAPP_URL`
3) Запуск:
```bash
pip install -r requirements.txt
python bot.py
```
